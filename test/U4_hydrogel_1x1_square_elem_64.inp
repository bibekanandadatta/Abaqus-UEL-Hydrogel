*Heading
** simulation of free-swelling of 2 mm x 2mm square plate under plane strain
** using symmetry a quarter of the plate (1mm x 1mm) was modeled using U4 element
** It starts from the dry state to a swollen equilibrium state
************************************************************************
** PARAMETERS (SI UNIT SYSTEM)
************************************************************************
*Parameter
** geometric parameters
nDim    = 2
nStress = 3
** element properties and material ID
nInt        = 4
matID       = 1
nPostVars   = 2*nStress + 1
** physical constants and material properties
Rgas    = 8.3145
theta   = 25.0 + 273.0
phi0    = 0.999
rho     = 1100.0
Gshear  = 100.0e3
kappa   = 50.0*Gshear
lam_L   = 0.
Vp      = 8.928e-3
mu0     = 0.0
Vw      = 1.8e-5
chi     = 0.485
Dw      = 1.7e-6
RT      = Rgas*theta
** initial condition
initMU  = mu0 + RT*(phi0+log(1-phi0)+chi*phi0**2) - kappa*Vw*log(phi0) + 0.5*kappa*Vw*(log(phi0))**2
** physical constants and material properties
tRamp   = 3600.0*3.0
tEnd    = 3600.0*24.0
dtInit  = 10.0
dtMax   = 500.0
dtMin   = 1.0e-6
************************************************************************
** GEOMETRY and MESH
************************************************************************
*Node
1,           0., 0.00100000005
2,           0., 0.000899999985
3,           0., 0.000793713029
4,           0., 0.000680743775
5,           0., 0.000560672197
6,           0., 0.000433051726
7,           0., 0.000297407794
8,           0., 0.000153235917
9,           0.,           0.
10, 0.000153235917, 0.00100000005
11, 0.000153235917, 0.000899999985
12, 0.000153235917, 0.000793713029
13, 0.000153235917, 0.000680743775
14, 0.000153235917, 0.000560672197
15, 0.000153235917, 0.000433051726
16, 0.000153235917, 0.000297407794
17, 0.000153235917, 0.000153235917
18, 0.000153235917,           0.
19, 0.000297407794, 0.00100000005
20, 0.000297407794, 0.000899999985
21, 0.000297407794, 0.000793713029
22, 0.000297407794, 0.000680743775
23, 0.000297407794, 0.000560672197
24, 0.000297407794, 0.000433051726
25, 0.000297407794, 0.000297407794
26, 0.000297407794, 0.000153235917
27, 0.000297407794,           0.
28, 0.000433051726, 0.00100000005
29, 0.000433051726, 0.000899999985
30, 0.000433051726, 0.000793713029
31, 0.000433051726, 0.000680743775
32, 0.000433051726, 0.000560672197
33, 0.000433051726, 0.000433051726
34, 0.000433051726, 0.000297407794
35, 0.000433051726, 0.000153235917
36, 0.000433051726,           0.
37, 0.000560672197, 0.00100000005
38, 0.000560672197, 0.000899999985
39, 0.000560672197, 0.000793713029
40, 0.000560672197, 0.000680743775
41, 0.000560672197, 0.000560672197
42, 0.000560672197, 0.000433051726
43, 0.000560672197, 0.000297407794
44, 0.000560672197, 0.000153235917
45, 0.000560672197,           0.
46, 0.000680743775, 0.00100000005
47, 0.000680743775, 0.000899999985
48, 0.000680743775, 0.000793713029
49, 0.000680743775, 0.000680743775
50, 0.000680743775, 0.000560672197
51, 0.000680743775, 0.000433051726
52, 0.000680743775, 0.000297407794
53, 0.000680743775, 0.000153235917
54, 0.000680743775,           0.
55, 0.000793713029, 0.00100000005
56, 0.000793713029, 0.000899999985
57, 0.000793713029, 0.000793713029
58, 0.000793713029, 0.000680743775
59, 0.000793713029, 0.000560672197
60, 0.000793713029, 0.000433051726
61, 0.000793713029, 0.000297407794
62, 0.000793713029, 0.000153235917
63, 0.000793713029,           0.
64, 0.000899999985, 0.00100000005
65, 0.000899999985, 0.000899999985
66, 0.000899999985, 0.000793713029
67, 0.000899999985, 0.000680743775
68, 0.000899999985, 0.000560672197
69, 0.000899999985, 0.000433051726
70, 0.000899999985, 0.000297407794
71, 0.000899999985, 0.000153235917
72, 0.000899999985,           0.
73, 0.00100000005, 0.00100000005
74, 0.00100000005, 0.000899999985
75, 0.00100000005, 0.000793713029
76, 0.00100000005, 0.000680743775
77, 0.00100000005, 0.000560672197
78, 0.00100000005, 0.000433051726
79, 0.00100000005, 0.000297407794
80, 0.00100000005, 0.000153235917
81, 0.00100000005,           0.
*User Element,Type=U4,Nodes=4,Coordinates=2,Properties=12,Iproperties=3,Variables=4,Unsymm
1,2,11
*Element, type=U4
1,  1,  2, 11, 10
2,  2,  3, 12, 11
3,  3,  4, 13, 12
4,  4,  5, 14, 13
5,  5,  6, 15, 14
6,  6,  7, 16, 15
7,  7,  8, 17, 16
8,  8,  9, 18, 17
9, 10, 11, 20, 19
10, 11, 12, 21, 20
11, 12, 13, 22, 21
12, 13, 14, 23, 22
13, 14, 15, 24, 23
14, 15, 16, 25, 24
15, 16, 17, 26, 25
16, 17, 18, 27, 26
17, 19, 20, 29, 28
18, 20, 21, 30, 29
19, 21, 22, 31, 30
20, 22, 23, 32, 31
21, 23, 24, 33, 32
22, 24, 25, 34, 33
23, 25, 26, 35, 34
24, 26, 27, 36, 35
25, 28, 29, 38, 37
26, 29, 30, 39, 38
27, 30, 31, 40, 39
28, 31, 32, 41, 40
29, 32, 33, 42, 41
30, 33, 34, 43, 42
31, 34, 35, 44, 43
32, 35, 36, 45, 44
33, 37, 38, 47, 46
34, 38, 39, 48, 47
35, 39, 40, 49, 48
36, 40, 41, 50, 49
37, 41, 42, 51, 50
38, 42, 43, 52, 51
39, 43, 44, 53, 52
40, 44, 45, 54, 53
41, 46, 47, 56, 55
42, 47, 48, 57, 56
43, 48, 49, 58, 57
44, 49, 50, 59, 58
45, 50, 51, 60, 59
46, 51, 52, 61, 60
47, 52, 53, 62, 61
48, 53, 54, 63, 62
49, 55, 56, 65, 64
50, 56, 57, 66, 65
51, 57, 58, 67, 66
52, 58, 59, 68, 67
53, 59, 60, 69, 68
54, 60, 61, 70, 69
55, 61, 62, 71, 70
56, 62, 63, 72, 71
57, 64, 65, 74, 73
58, 65, 66, 75, 74
59, 66, 67, 76, 75
60, 67, 68, 77, 76
61, 68, 69, 78, 77
62, 69, 70, 79, 78
63, 70, 71, 80, 79
64, 71, 72, 81, 80
*System
*Nset, nset=All, generate
1,  81,   1
*Elset, elset=All, generate
1,  64,   1
*Nset, nset=Bottom, generate
9,  81,   9
*Elset, elset=Bottom, generate
8,  64,   8
*Nset, nset=Left, generate
1,  9,  1
*Elset, elset=Left, generate
1,  8,  1
*Nset, nset=Right, generate
73,  81,   1
*Elset, elset=Right, generate
57,  64,   1
*Nset, nset=Top, generate
1,  73,   9
*Elset, elset=Top, generate
1,  57,   8
*Element, type=CPE4
100001, 1, 2, 11, 10
100002, 2, 3, 12, 11
100003, 3, 4, 13, 12
100004, 4, 5, 14, 13
100005, 5, 6, 15, 14
100006, 6, 7, 16, 15
100007, 7, 8, 17, 16
100008, 8, 9, 18, 17
100009, 10, 11, 20, 19
100010, 11, 12, 21, 20
100011, 12, 13, 22, 21
100012, 13, 14, 23, 22
100013, 14, 15, 24, 23
100014, 15, 16, 25, 24
100015, 16, 17, 26, 25
100016, 17, 18, 27, 26
100017, 19, 20, 29, 28
100018, 20, 21, 30, 29
100019, 21, 22, 31, 30
100020, 22, 23, 32, 31
100021, 23, 24, 33, 32
100022, 24, 25, 34, 33
100023, 25, 26, 35, 34
100024, 26, 27, 36, 35
100025, 28, 29, 38, 37
100026, 29, 30, 39, 38
100027, 30, 31, 40, 39
100028, 31, 32, 41, 40
100029, 32, 33, 42, 41
100030, 33, 34, 43, 42
100031, 34, 35, 44, 43
100032, 35, 36, 45, 44
100033, 37, 38, 47, 46
100034, 38, 39, 48, 47
100035, 39, 40, 49, 48
100036, 40, 41, 50, 49
100037, 41, 42, 51, 50
100038, 42, 43, 52, 51
100039, 43, 44, 53, 52
100040, 44, 45, 54, 53
100041, 46, 47, 56, 55
100042, 47, 48, 57, 56
100043, 48, 49, 58, 57
100044, 49, 50, 59, 58
100045, 50, 51, 60, 59
100046, 51, 52, 61, 60
100047, 52, 53, 62, 61
100048, 53, 54, 63, 62
100049, 55, 56, 65, 64
100050, 56, 57, 66, 65
100051, 57, 58, 67, 66
100052, 58, 59, 68, 67
100053, 59, 60, 69, 68
100054, 60, 61, 70, 69
100055, 61, 62, 71, 70
100056, 62, 63, 72, 71
100057, 64, 65, 74, 73
100058, 65, 66, 75, 74
100059, 66, 67, 76, 75
100060, 67, 68, 77, 76
100061, 68, 69, 78, 77
100062, 69, 70, 79, 78
100063, 70, 71, 80, 79
100064, 71, 72, 81, 80
*Elset, elset=ElDummy, generate
100001,100064,1
** EXTRA ELEMENT
*Node
999996, 0.0, 0.0
999997, .00001, 0.0
999998, .00001, .00001
999999, 0.0, .00001
*Element, Type=CPE4T
999999,999996,999997,999998,999999
*Nset, nset=extraElement
999996,999997,999998,999999
*Elset,elset=extraElement
999999
*************************************************************************** 
** MATERIAL DEFINITION 
***************************************************************************
** Material properties for the Swellable Gel Elements
*uel property,elset=all
** Rgas theta phi0 rho Gshear kappa lam_L Vp 
<Rgas>, <theta>, <phi0>, <rho>, <Gshear>, <kappa>, <lam_L>, <Vp>, 
** mu0 Vw chi Dw nInt matID nPostVars
<mu0>, <Vw>, <chi>, <Dw>, <nInt>, <matID>, <nPostVars>
***************************************************************************
*Solid section, elset=ElDummy, material=DummyMaterial 
*Material, name=DummyMaterial
*Elastic
1.e-20
** strain and stress vector (3+3) and polymer vol fraction as user output
*User output variables
<nPostVars>
***************************************************************************
*Solid section, elset=extraElement, material=extraMaterial
*Material, name=extraMaterial
*Elastic
1.e-20
*Conductivity
1.0
*Density
1.0
*Specific heat
1.0
************************************************************************
** INITIAL CONDITIONS
************************************************************************
** Define the initial chemical potential
*Initial conditions, type=temperature
all, <initMU>
** Define an arbitrary initial condition for the ‘‘extra’’ element. 
*Initial conditions, type=temperature
extraElement, 0.0
************************************************************************
** AMPLITUDE DEFINITION
************************************************************************
*Amplitude, name=chemProfile, definition=decay
<mu0>, <initMU>, 0.0, <tRamp>
************************************************************************
** STEP DEFINITION
************************************************************************
*Step, Name=Swell, nlgeom=yes, inc=50000, UNSYMM=YES
*Coupled temperature-displacement, stabilize, deltmx=100.0
<dtInit>, <tEnd>, <dtMin>, <dtMax>
*Boundary
left,1,1,0.0
bottom,2,2,0.0
*Boundary, amplitude=chemProfile 
top,11,11,1.0
right,11,11,1.0
*Boundary
extraElement,encastre
extraElement,11,11,0.0
************************************************************************
*Output, field, frequency=1, time marks=no
*node output, nset=all
u, nt, rf
** specify the user-defined output for the dummy element set
*element output, elset=elDummy
uvarm, le
*End Step
************************************************************************